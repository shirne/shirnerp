"use strict";function del(t,n){return dialog.confirm(n,function(){location.href=$(t).attr("href")}),!1}function lang(t){return window.language&&window.language[t]?window.language[t]:t}function randomString(t,n){for(var e="",i=(n=n||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,o=0;o<t;o++){var s=Math.floor(Math.random()*i);e+=n.substring(s,s+1)}return e}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,n){if(!t&&!n)return!0;if(!t||!n)return!1;var e=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(n);if(e.length!=i.length)return!1;for(var o=0;o<e.length;o++){var s=e[o];if(t[s]!==n[s])return!1}return!0}function array_combine(t,n){for(var e={},i=0;i<t.length&&!(n.length<i+1);i++)e[t[i]]=n[i];return e}function tostring(t){return t&&t.toString?t.toString():""}function callfunc(t,n,e,i){var o;return e?0<=(o=(e="string"==typeof e?e.split(","):e).indexOf("###"))?e[o]=t:e=[t].concat(e):e=[t],window[n]?window[n].apply(i,e):null==t?"":t}function html_encode(t){if(!t)return t;null!=(n=document.createElement("div")).textContent?n.textContent=t:n.innerText=t;var t=n.innerHTML,n=null;return t}function html_decode(t){if(!t)return t;(n=document.createElement("div")).innerHTML=t;var t=n.innerText||n.textContent,n=null;return t}function pad_zero(t,n){return(t+="").length<n?new Array(++n-t.length).join("0")+t:t}function timestamp_date(t,n){if(!t)return"";var i=new Date(1e3*t),e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"},s=["","January","February","March","April","May","June","July","August","September","October","November","December"],r={d:function(){return pad_zero(r.j(),2)},D:function(){return r.l().substr(0,3)},j:function(){return i.getDate()},l:function(){return e[r.w()]},N:function(){return r.w()+1},S:function(){return o[r.j()]?o[r.j()]:"th"},w:function(){return i.getDay()},z:function(){return(i-new Date(i.getFullYear()+"/1/1"))/864e5>>0},W:function(){var t=r.z(),n=364+r.L()-t,e=(new Date(i.getFullYear()+"/1/1").getDay()||7)-1;return n<=2&&(i.getDay()||7)-1<=2-n?1:t<=2&&4<=e&&6-e<=t?(n=new Date(i.getFullYear()-1+"/12/31"),timestamp_date(Math.round(n.getTime()/1e3),"W")):1+(e<=3?(t+e)/7:(t-(7-e))/7)>>0},F:function(){return s[r.n()]},m:function(){return pad_zero(r.n(),2)},M:function(){return r.F().substr(0,3)},n:function(){return i.getMonth()+1},t:function(){var t;return 2==(t=i.getMonth()+1)?28+r.L():1&t&&t<8||!(1&t)&&7<t?31:30},L:function(){var t=r.Y();return 3&t||!(t%100)&&t%400?0:1},Y:function(){return i.getFullYear()},y:function(){return(i.getFullYear()+"").slice(2)},a:function(){return 11<i.getHours()?"pm":"am"},A:function(){return r.a().toUpperCase()},B:function(){var t=60*(i.getTimezoneOffset()+60),t=3600*i.getHours()+60*i.getMinutes()+i.getSeconds()+t,t=Math.floor(t/86.4);return 1e3<t&&(t-=1e3),t<0&&(t+=1e3),1==String(t).length&&(t="00"+t),t=2==String(t).length?"0"+t:t},g:function(){return i.getHours()%12||12},G:function(){return i.getHours()},h:function(){return pad_zero(r.g(),2)},H:function(){return pad_zero(i.getHours(),2)},i:function(){return pad_zero(i.getMinutes(),2)},s:function(){return pad_zero(i.getSeconds(),2)},O:function(){var t=pad_zero(Math.abs(i.getTimezoneOffset()/60*100),4);return t=0<i.getTimezoneOffset()?"-"+t:"+"+t},P:function(){var t=r.O();return t.substr(0,3)+":"+t.substr(3,2)},c:function(){return r.Y()+"-"+r.m()+"-"+r.d()+"T"+r.h()+":"+r.i()+":"+r.s()+r.P()},U:function(){return Math.round(i.getTime()/1e3)}};return(n=n||"Y-m-d H:i:s").replace(/[\\]?([a-zA-Z])/g,function(t,n){return t==n&&r[n]?r[n]():n})}function iif(t,n,e){return(t="0"===t?0:t)?n:e}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Number.prototype.format=function(t){for(var t=this.toFixed(t=void 0===t?2:t).split("."),n=[],e=t[0].split(""),i=e.length,o=0;o<i;o++)0<o&&o%3==0&&n.unshift(","),n.unshift(e[i-o-1]);return n.join("")+(2==t.length?"."+t[1]:"")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s+|\s+$)/g,"")}),String.prototype.compile=function(a,t){if(t){var n,e=[];for(n in a)e.push(this.compile(a[n]));return e.join("\n")}return this.replace(/\{if\s+([^\}]+)\}([\W\w]*?){\/if}/g,function(t,n,e){var i=e.split("{else}");if(o=n.match(/\s+(=+|<|>)\s+/)){var o=o[0],s=n.split(o);0===s[0].indexOf("@")&&(s[0]=a[s[0].replace("@","")]),0===s[1].indexOf("@")&&(s[1]=a[s[1].replace("@","")]);var r=!1;switch(o=o.trim()){case"==":r=s[0]==s[1];break;case"===":r=s[0]===s[1];break;case">":r=s[0]>s[1];break;case"<":r=s[0]<s[1]}if(r)return e;if(i[1])return i[1]}else{if(a[n.replace("@","")])return i[0];if(i[1])return i[1]}return""}).replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([^\}]+))?)?\}/g,function(t,n,e,i){if(0<n.indexOf(".")){for(var o=n.split("."),s=a,r=0;r<o.length;r++){if(void 0===s[o[r]]||null===s[o[r]]){s="";break}s=s[o[r]]}return callfunc(s,e,i)}return callfunc(a[n],e,i,a)})},window.default=function(t,n){return t||n},function(o,m){var r='<div class="modal shirne-modal fade" id="{@id}" {if tabindex}tabindex="{@tabindex}"{/if} role="dialog" aria-labelledby="{@id}Label" aria-hidden="true">\n    <div class="modal-dialog {@size}">\n        <div class="modal-content {@contentClass}">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label">{@title}</h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body {@bodyClass}">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>',s=0;function a(t,n){return(t=_typeof(t)===_typeof("a")?{text:t,isdefault:!!n}:t).isdefault&&(t.type||(t.type="primary")),t}function b(t){if((t=t||{}).btns)if("string"==typeof t.btns)t.btns=[a(t.btns,!0)];else if(t.btns instanceof Array)for(var n=0;n<t.btns.length;n++)t.btns[n]=a(t.btns[n]);else console.error("Dialog::construct argument btns error."),t.btns=[];this.options=m.extend({id:"modal_dialog_"+s++,header:!0,footer:!0,backdrop:!0,tabindex:-1,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],contentClass:"",onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),this.options.btns||(this.options.btns=[]);var e=this.options.btns.length;if(t.addbtn&&(this.options.btns||(this.options.btns=[]),t.addbtn=a(t.addbtn),e<1?this.options.btns.unshift(t.addbtn):this.options.btns.splice(e-1,0,t.addbtn),e=1),t.addbtns){if(this.options.btns||(this.options.btns=[]),e<1)this.options.btns=t.addbtns;else{for(var i=[e-1,0],n=0;n<t.addbtns.length;n++)i.push(a(t.addbtns[n]));this.options.btns.splice.apply(this.options.btns,i)}e=1}e<1&&(this.options.footer=!1),this.closed=!0,this.box=m(this.options.id)}b.prototype.generBtn=function(t,n){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class||"btn-outline-secondary")+'" '+(t.isdefault?"default":"")+' data-index="'+n+'">'+t.text+"</a>"},b.prototype.getDefaultBtn=function(){for(var t=null,n=0;n<this.options.btns.length&&!(t=this.options.btns[n]).isdefault;n++);return t},b.prototype.show=function(t,n){this.box=m("#"+this.options.id),n=n||"系统提示",this.box.length<1?(m(document.body).append(r.compile({id:this.options.id,bodyClass:this.options.bodyClass,contentClass:this.options.contentClass,tabindex:this.options.tabindex,size:this.options.size?"modal-"+this.options.size:"",title:n})),this.box=m("#"+this.options.id)):(this.box.unbind(),this.box.find(".modal-title").text(n)),this.options.header||this.box.find(".modal-header").remove(),this.options.footer||this.box.find(".modal-footer").remove(),!0!==this.options.backdrop&&(this.box.data("backdrop",this.options.backdrop),!1===this.options.backdrop&&this.box.css({height:0,overflow:"visible"})),this.options.keyboard||this.box.data("keyboard",!1);var e=this;b.instance=e;for(var i=[],o=0;o<this.options.btns.length;o++)i.push(this.generBtn(this.options.btns[o],o));this.box.find(".modal-footer .nav").html(i.join("\n"));var s=this.box.find(".modal-body");return s.html(t),this.box.on("hide.bs.modal",function(){e.options.onhide&&e.options.onhide(s,e.box),b.instance=null}),this.box.on("hidden.bs.modal",function(){e.options.onhidden&&e.options.onhidden(s,e.box),e.closed=!0,e.box.remove(),e.box=null}),this.box.on("show.bs.modal",function(){e.options.onshow&&e.options.onshow(s,e.box)}),this.box.on("shown.bs.modal",function(){return e.box&&e.closed?e.box.modal("hide"):void(e.options.onshown&&e.options.onshown(s,e.box))}),this.options.footer&&this.box.find(".modal-footer .btn").click(function(){var t=!0,n=m(this).data("index");e.options.btns[n].click?t=e.options.btns[n].click.apply(this,[s,e.box]):e.options.btns[n].isdefault&&e.options.onsure&&(t=e.options.onsure.apply(this,[s,e.box])),!1!==t&&e.box.modal("hide")}),this.closed=!1,this.box.modal("show"),this},b.prototype.hide=b.prototype.close=function(){return this.box&&!this.closed&&(this.closed=!0,this.box.modal("hide")),this};var c={error:function(t,n){return this.message(t,"error",n)},success:function(t,n){return this.message(t,"success",n)},warning:function(t,n){return this.message(t,"warning",n)},info:function(t,n){return this.message(t,"info",n)},loading:function(t,n){return this.message(t||"加载中...","loading",n)},message:function(t,n,e){var i="bg-info text-white",o="information-circle";if(n)switch(n){case"danger":case"error":o="close-circle",i="bg-danger text-white";break;case"warning":o="warning",i="bg-warning text-white";break;case"loading":o='<div class="spinner-border text-light" role="status">\n  <span class="sr-only">Loading...</span>\n</div>',i="bg-info text-white",e=e||10;break;case"success":o="checkmark-circle",i="bg-success text-white"}var n='<div class="dialog-message" >'+(o="loading"!=n?'<i class="ion-md-'+o+'"></i>':o)+"&nbsp;&nbsp;"+t+("loading"==n?"":'<a href="javascript:" class="ion-md-close closebtn"></a>')+"</div>",s=new b({footer:!1,header:!1,backdrop:!1,tabindex:"",size:"sm",contentClass:i,onshow:function(t){t.find(".closebtn").click(function(){s.close()})}}).show(n,"");return e=e||2,setTimeout(function(){s.close()},1e3*e),s},alert:function(t,n,e){var i=!1,o="function"==typeof n,s="",r="sm",a="";if(void 0===n||o||(e=n),m.isPlainObject(t)){if(t.title&&(s=t.title),void 0!==t.size&&(r=t.size),void 0===t.content)throw"message.content can not be empty.";t=t.content}var l={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},c="primary";return void 0===e?e="information-circle":l[e]&&(c="error"==e?"danger":e,e=l[e]),a=e?"none"==e?'<div class="container-fluid">{@message}</div>'.compile({message:t}):'<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:e,color:c}):t,new b({btns:"确定",size:r,header:!!s,onsure:function(){if(o)return n(i=!0)},onhide:function(){!i&&o&&n(!1)}}).show(a,s)},confirm:function(t,n,e,i,o){var s=!1;"function"!=typeof n?(i=n,"function"==typeof e?(n=e,e=null):o=e):"function"!=typeof e&&(o=i,i=e),"number"==typeof i&&(o=i,i=void 0);var r="",a="sm";if(m.isPlainObject(t)){if(t.title&&(r=t.title),void 0!==t.size&&(a=t.size),void 0!==t.btns&&t.btns,void 0===t.content)throw"message.content can not be empty.";t=t.content}var l={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},c="primary";void 0===i?i="information-circle":l[i]&&(c="error"===i?"danger":i,i=l[i]);var d,u,c="none"==i?'<div class="container-fluid">{@message}</div>'.compile({message:t}):'<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:i,color:c}),p=0,r=new b({header:!!r,size:a,backdrop:"static",onsure:function(){if(n&&"function"==typeof n)return s=!0,n()},onhide:function(){if(clearInterval(p),!1===s&&"function"==typeof e)return e()}}).show(c,r);return o&&"number"==typeof o&&(d=r.box.find(".modal-footer .btn-outline-primary"),u=r.getDefaultBtn().text,d.addClass("disabled").text(u+"("+o+")"),p=setInterval(function(){0<--o?d.text(u+"("+o+")"):(d.text(u),d.removeClass("disabled"),clearInterval(p))},1e3)),r},prompt:function(e,i,t){var n='<div class="form-group">{@input}</div>',o="请输入信息",s=!1,r=!1,a={},l=!0,c="";"string"==typeof e?o=e:(o=e.title,e.content&&(n=-1<e.content.indexOf("{@input}")?e.content:e.content+n),e.multi&&(s=!0,a=e.multi),e.is_textarea&&(r=!0),void 0!==e.keyboard?l=e.keyboard:r&&(l=!1),e.default&&(c=e.default.toString()));var d=r?'<textarea name="confirm_input" class="form-control" ></textarea>':'<input type="text" name="confirm_input" class="form-control" />';if(s)for(var u in d="",a){var p=a[u],f="",h=!1;"object"===_typeof(p)&&(f=p.value||"",h=p.is_textarea||r,p=p.label||p.title||u),d+=h?'<div class="input-group mt-2"><div class="input-group-prepend"><span class="input-group-text">'+p+'</span></div><textarea name="confirm_input" data-key="'+u+'" class="form-control" >'+f+"</textarea></div>":'<div class="input-group mt-2"><div class="input-group-prepend"><span class="input-group-text">'+p+'</span></div><input type="text" data-key="'+u+'" name="confirm_input" value="'+f+'" class="form-control" /></div>'}return new b({backdrop:"static",keyboard:l,onshow:function(t){e&&e.onshow&&e.onshow(t)},onshown:function(t){var n=t.find("[name=confirm_input]").eq(0);c&&n.val(c),n.select(),e&&e.onshown&&e.onshown(t)},onsure:function(t){var n=t.find("[name=confirm_input]"),e=n.val();if(s&&(e={},n.each(function(){var t=m(this).data("key");e[t]=m(this).val()})),"function"==typeof i){t=i(e,t);return!0===t&&0,t}},onhide:function(){!1}}).show(n.compile({input:d}),o)},action:function(t,e,n){var t='<div class="list-group"  style="max-height: 70vh;overflow: auto;"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",i=null,o=new b({bodyClass:"modal-action",backdrop:"static",size:"sm",btns:[{text:"取消",type:"secondary"}],onshow:function(t){(i=t.find(".list-group-item-action")).click(function(t){i.removeClass("active"),m(this).addClass("active");var n=i.index(this);"function"==typeof e&&!1===e(n)||o.close()})},onsure:function(t){return!0},onhide:function(){return!0}}).show(t,n||"请选择")},pickList:function(r,n,a){"string"==typeof r&&(r={url:r});var t=(r="[object Array]"==Object.prototype.toString.call(r)?{isajax:!1,list:r}:r).icon?'<i class="ion-md-checkmark"></i> ':"";r=m.extend({url:"",title:"",isajax:!0,list:[],name:"项目",searchHolder:"根据名称搜索",idkey:"id",titlekey:"title",onRow:null,extend:null,rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action" style="line-height:30px;">'+t+"[{@id}]&nbsp;{@title}</a>"},r||{});var l=null,e="";r.extend&&(e='<select name="'+r.extend.name+'" class="form-control"><option value="">'+r.extend.title+"</option></select>"),a=a||{};var i="请选择"+r.name,t='<div class="list-group list-group-picker mt-2" style="max-height:500px;overflow: auto;"></div>';return r.isajax&&(i="请搜索并选择"+r.name,t='<div class="input-group">'+e+'<input type="text" class="form-control searchtext" name="keyword" placeholder="'+r.searchHolder+'"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div>'+t),r.title||(r.title=i),new b({backdrop:"static",onshown:function(t){var n,e=t.find(".searchbtn"),i=t.find(".searchtext"),o=t.find(".list-group"),s=!1;o.on("click","a.list-group-item",function(){for(var t=m(this).data("id"),n=0;n<r.list.length;n++)if(r.list[n][r.idkey]==t){l=r.list[n],o.find("a.list-group-item").removeClass("active"),m(this).addClass("active");break}}),r.isajax?(n=null,r.extend&&(n=t.find("[name="+r.extend.name+"]"),r.extend.list?n.append(r.extend.htmlRow.compile(r.extend.list,!0)):m.ajax({url:r.extend.url,type:"GET",dataType:"JSON",success:function(t){n.append(r.extend.htmlRow.compile(t.data,!0))}})),e.click(function(){s||(s=!0,o.html('<span class="list-loading">加载中...</span>'),a.key=i.val(),r.extend&&(a[r.extend.name]=n.val()),m.ajax({url:r.url,type:"GET",dataType:"JSON",data:a,success:function(t){s=!1,1===t.code?t.data&&t.data.length?(r.list=t.data,o.html(r.rowTemplate.compile(t.data,!0))):o.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到'+r.name+"</span>"):o.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>')}}))}).trigger("click")):o.html(r.rowTemplate.compile(r.list,!0))},onsure:function(t){return l?"function"==typeof n?n(l):void 0:(c.warning("没有选择"+r.name+"!"),!1)}}).show(t,r.title)},pickUser:function(t,n,e){return"object"!=_typeof(n)||e||(e=n,n=null),this.pickList({url:o.get_search_url("member"),title:n,name:"会员",searchHolder:"根据会员id或名称，电话来搜索",rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action" style="line-height:30px;">{if @avatar}<img src="{@avatar}" style="width:30px;height:30px;border-radius: 100%;margin-right:10px;" />{else}<i class="ion-md-person"></i>{/if} [{@id}]&nbsp;{if @nickname}{@nickname}{else}{@username}{/if}&nbsp;&nbsp;&nbsp;{if @mobile}<small><i class="ion-md-phone-portrait"></i> {@mobile}</small>{/if}</a>'},t,e)},pickArticle:function(t,n,e){return"object"!=_typeof(n)||e||(e=n,n=null),this.pickList({url:o.get_search_url("article"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @cover}<div style="background-image:url({@cover})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@description}</div></a>',title:n,name:"文章",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("article"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据文章标题搜索"},t,e)},pickProduct:function(t,n,e){"object"!=_typeof(n)||e||(e=n,n=null);var i=e&&e.searchtype?'<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />[{@sku_goods_no}]&nbsp;{@price}</div>':'<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@min_price}{if @max_price>@min_price}~{@max_price}{/if}</div>';return this.pickList({url:o.get_search_url("product"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @image}<div style="background-image:url({@image})" class="imgview" ></div>{/if}'+i+"</a>",title:n,name:"产品",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("product"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据产品名称搜索"},t,e)},pickLocate:function(t,n,r){var a=null,e=.6*m(o).height();return new b({size:"lg",backdrop:"static",onshown:function(t){var e=t.find(".searchbtn"),i=t.find(".searchtext"),o=t.find(".map"),s=t.find(".mapinfo");setTimeout(function(){var n=InitMap("tencent",o,function(t,n){s.html(t+"&nbsp;"+n.lng+","+n.lat),a=n},r);e.click(function(){var t=i.val();n.setLocate(t)}),t.find(".setToCenter").click(function(t){n.showAtCenter()})},500)},onsure:function(t){return a?"function"==typeof n?n(a):void 0:(c.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2" style="height:'+e+'px"></div><div class="float-right mt-2 mapactions"><a href="javascript:" class="setToCenter">定位到地图中心</a></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};m(document).on("keydown",function(t){13!=t.keyCode||(t=m(".shirne-modal").eq(-1))&&!1!==t.data("keyboard")&&t.find(".modal-footer .btn[default]").trigger("click")}),o.Dialog=m.Dialog=b,o.dialog=m.dialog=c}(window,jQuery||Zepto);
//# sourceMappingURL=label.min.js.map
